function AbsolutePosition(el){var SL=0,ST=0;var is_div=/^div$/i.test(el.tagName);if(is_div&&el.scrollLeft){SL=el.scrollLeft}if(is_div&&el.scrollTop){ST=el.scrollTop}var r={x:el.offsetLeft-SL,y:el.offsetTop-ST};if(el.offsetParent){var tmp=AbsolutePosition(el.offsetParent);r.x+=tmp.x;r.y+=tmp.y}return r}function NewAutoComplete(input,db){if(!input.parentNode){input=document.getElementById(input)}var ac=new jsAC(input,db)}function jsAC(input,db){this.input=input;this.init();this.db=db}jsAC.prototype.toString=function(){return"[AutoComplete Object]"};jsAC.prototype.init=function(){var ac=this;this.input.onkeydown=function(event){return ac.onkeydown(this,event)};this.input.onkeyup=function(event){ac.onkeyup(this,event)};this.input.onblur=function(){ac.onblur(this)};this.popup=document.createElement("div");this.popup.id="autocomplete"};jsAC.prototype.hidePopup=function(){if(this.selected){this.input.value=this.selected.innerHTML}if(this.popup.parentNode&&this.popup.parentNode.tagName){this.popup.parentNode.removeChild(this.popup)}};jsAC.prototype.onkeydown=function(input,e){if(!e){e=window.event}switch(e.keyCode){case 40:this.selectDown();return false;case 38:this.selectUp();return false;default:return true}};jsAC.prototype.onkeyup=function(input,e){if(!e){e=window.event}switch(e.keyCode){case 38:case 40:case 37:case 39:case 33:case 34:case 36:case 35:case 27:case 16:case 17:case 18:case 20:return true;case 9:case 13:this.hidePopup();return true;default:if(input.value.length>0){this.populatePopup()}else{this.hidePopup()}return true}};jsAC.prototype.onblur=function(input){this.hidePopup()};jsAC.prototype.select=function(node){this.input.value=node.innerHTML};jsAC.prototype.selectDown=function(){if(this.selected){if(this.selected.nextSibling&&this.selected.nextSibling.tagName){this.highlight(this.selected.nextSibling)}}else{var ps=this.popup.getElementsByTagName("p");if(ps.length>0){this.highlight(ps[0])}}};jsAC.prototype.selectUp=function(){if(this.selected&&this.selected.previousSibling&&this.selected.previousSibling.tagName){this.highlight(this.selected.previousSibling)}};jsAC.prototype.template=function(){};jsAC.prototype.highlight=function(node){if(this.selected){this.selected.className=""}node.className="selected";this.selected=node;this.input.value=node.innerHTML};jsAC.prototype.unhighlight=function(node){node.className="";this.selected=false};jsAC.prototype.populatePopup=function(){var ac=this;this.selected=false;var pos=AbsolutePosition(this.input);this.popup.style.top=(pos.y+this.input.offsetHeight)+"px";this.popup.style.left=pos.x+"px";this.popup.style.width=(this.input.offsetWidth-4)+"px";this.db.onmatch=function(matches){ac.found(matches)};this.db.search(this.input.value)};jsAC.prototype.found=function(matches){while(this.popup.hasChildNodes()){this.popup.removeChild(this.popup.childNodes[0])}if(!this.popup.parentNode||!this.popup.parentNode.tagName){document.getElementsByTagName("body")[0].appendChild(this.popup)}var div=document.createElement("div");var ac=this;if(matches.length>0){for(var i in matches){var p=document.createElement("p");p.appendChild(document.createTextNode(matches[i]));p.onmousedown=function(){ac.select(this)};p.onmouseover=function(){ac.highlight(this)};p.onmouseout=function(){ac.unhighlight(this)};div.appendChild(p)}this.popup.appendChild(div)}else{this.hidePopup()}};function ACDB(){this.max=15;this.delay=300;this.docache=false;this.cache={}}ACDB.prototype.toString=function(){return"[AutoComplete Database]"};ACDB.prototype.search=function(search_string){if(!this.dosearch){return false}if(this.docache){this.search_string=search_string;if(this.cache[search_string]){return this.match(this.cache[search_string])}}var db=this;if(this.timer){clearTimeout(this.timer)}this.timer=setTimeout(function(){db.dosearch(search_string)},this.delay)};ACDB.prototype.match=function(matches){if(this.docache){this.cache[this.search_string]=matches}if(this.onmatch){this.onmatch(matches)}};function ACDB_JS(array_of_strings){this.strings=array_of_strings;this.delay=30}ACDB_JS.prototype=new ACDB;ACDB_JS.prototype.dosearch=function(search_string){var search_length=search_string.length;var matches=[];var test_string="";for(var i=0;test_string=this.strings[i];i++){if(test_string.substr(0,search_length).toLowerCase()==search_string.toLowerCase()){matches[matches.length]=test_string}if(matches.length>=this.max){break}}this.match(matches)};function ACDB_Remote(uri){this.uri=uri;this.delay=0;this.docache=true}ACDB_Remote.prototype=new ACDB;ACDB_Remote.prototype.dosearch=function(search_string){if(search_string&&search_string.length>2){HTTPGet(this.uri+search_string+"*&max="+this.max,this.receive,this)}};ACDB_Remote.prototype.receive=function(string,xmlhttp,acdb){if(xmlhttp.status!=200){return alert("An HTTP error "+xmlhttp.status+" occured.\n"+acdb.uri)}acdb.match(string.length>0?string.split("|"):[])};
function CreateHTTP(){var xmlhttp=false;
/*@cc_on @*/
/*@if (@_jscript_version >= 5)
  try {
    xmlhttp = new ActiveXObject("Msxml2.XMLHTTP");
  } catch (e) {
    try {
      xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
    } catch (E) {
      xmlhttp = false;
    }
  }
  @end @*/
if(!xmlhttp&&typeof XMLHttpRequest!="undefined"){xmlhttp=new XMLHttpRequest()}return xmlhttp}function HTTPGet(uri,callback_function,callback_parameter){var xmlhttp=CreateHTTP();var bAsync=true;if(!callback_function){bAsync=false}setTimeout(function(){xmlhttp.abort()},5000);xmlhttp.open("GET",uri,bAsync);xmlhttp.send(null);if(bAsync){if(callback_function){xmlhttp.onreadystatechange=function(){if(xmlhttp.readyState==4){callback_function(xmlhttp.responseText,xmlhttp,callback_parameter)}}}return true}else{return xmlhttp.responseText}}function HTTPinto(html,http,node){node.innerHTML=html};
var nodes=new Array();var openNodes=new Array();var icons=new Array(6);function preloadIcons(resourceStaticPath){icons[0]=new Image();icons[0].src=resourceStaticPath+"/image/arbre/plus.gif";icons[1]=new Image();icons[1].src=resourceStaticPath+"/image/arbre/plusbottom.gif";icons[2]=new Image();icons[2].src=resourceStaticPath+"/image/arbre/minus.gif";icons[3]=new Image();icons[3].src=resourceStaticPath+"/image/arbre/minusbottom.gif";icons[4]=new Image();icons[4].src=resourceStaticPath+"/image/arbre/folder.gif";icons[5]=new Image();icons[5].src=resourceStaticPath+"/image/arbre/folderopen.gif";icons[6]=new Image();icons[6].src=resourceStaticPath+"/image/arbre/action.gif";icons[7]=new Image();icons[7].src=resourceStaticPath+"/image/arbre/actionopen.gif";icons[8]=new Image();icons[8].src=resourceStaticPath+"/image/arbre/pays.gif";icons[9]=new Image();icons[9].src=resourceStaticPath+"/image/arbre/paysopen.gif";icons[10]=new Image();icons[10].src=resourceStaticPath+"/image/arbre/onglet.gif";icons[11]=new Image();icons[11].src=resourceStaticPath+"/image/arbre/ongletopen.gif";icons[12]=new Image();icons[12].src=resourceStaticPath+"/image/arbre/applion.gif";icons[13]=new Image();icons[13].src=resourceStaticPath+"/image/arbre/applion.gif";icons[14]=new Image();icons[14].src=resourceStaticPath+"/image/arbre/applioff.gif";icons[15]=new Image();icons[15].src=resourceStaticPath+"/image/arbre/applioff.gif"}function createTree(arrName,resourceStaticPath,startNode,openNode){nodes=arrName;if(nodes.length>0){preloadIcons(resourceStaticPath);if(startNode==null){startNode=0}if(openNode!=0||openNode!=null){setOpenNodes(openNode)}if(startNode!=0){var nodeValues=nodes[getArrayId(startNode)].split("|");document.write('<a href="'+nodeValues[3]+'" onmouseover="window.status=\''+nodeValues[2].replace(/\'/g,"\\'")+'\';return true;" onmouseout="window.status=\' \';return true;"><img src="/image/arbre/folderopen.gif" align="absbottom" alt="" />'+nodeValues[2].replace(/\'/g,"\\'")+"</a><br />")}else{document.write('<img src="'+resourceStaticPath+'/image/arbre/base.gif" align="absbottom" alt="" /><span class=\'textbold\'>'+TreeName+"</span><br />")}var recursedNodes=new Array();addNode(resourceStaticPath,startNode,recursedNodes)}}function getArrayId(node){for(i=0;i<nodes.length;i++){var nodeValues=nodes[i].split("|");if(nodeValues[0]==node){return i}}}function getRankId(node){for(i=0;i<nodes.length;i++){var nodeValues=nodes[i].split("|");if(nodeValues[0]==node){return nodeValues[1]}}}function setOpenNodes(openNode){for(i=0;i<nodes.length;i++){var nodeValues=nodes[i].split("|");if(nodeValues[0]==openNode){openNodes.push(nodeValues[0]);setOpenNodes(nodeValues[1])}}}function isNodeOpen(node){for(i=0;i<openNodes.length;i++){if(openNodes[i]==node){return true}}return false}function hasChildNode(parentNode){for(i=0;i<nodes.length;i++){var nodeValues=nodes[i].split("|");if(nodeValues[1]==parentNode){return true}}return false}function lastSibling(node,parentNode){var lastChild=0;for(i=0;i<nodes.length;i++){var nodeValues=nodes[i].split("|");if(nodeValues[1]==parentNode){lastChild=nodeValues[0]}}if(lastChild==node){return true}return false}function addNode(resourceStaticPath,parentNode,recursedNodes){for(var i=0;i<nodes.length;i++){var nodeValues=nodes[i].split("|");if(nodeValues[1]==parentNode){var ls=lastSibling(nodeValues[0],nodeValues[1]);var hcn=hasChildNode(nodeValues[0]);var ino=isNodeOpen(nodeValues[0]);for(g=0;g<recursedNodes.length;g++){if(recursedNodes[g]==1){document.write('<img src="'+resourceStaticPath+'/image/arbre/line.gif" align="absbottom" alt="" />')}else{document.write('<img src="'+resourceStaticPath+'/image/arbre/empty.gif" align="absbottom" alt="" />')}}if(ls){recursedNodes.push(0)}else{recursedNodes.push(1)}if(hcn){if(ls){document.write('<a href="javascript: oc('+nodeValues[0]+', 1);"><img id="join'+nodeValues[0]+'" src="'+resourceStaticPath+"/image/arbre/");if(ino){document.write("minus")}else{document.write("plus")}document.write('bottom.gif" align="absbottom" alt="Open/Close node" /></a>')}else{document.write('<a name="c'+nodeValues[0]+'" href="javascript: oc('+nodeValues[0]+', 0);"><img id="join'+nodeValues[0]+'" src="'+resourceStaticPath+"/image/arbre/");if(ino){document.write("minus")}else{document.write("plus")}document.write('.gif" align="absbottom" alt="Open/Close node" /></a>')}}else{if(ls){document.write('<img src="'+resourceStaticPath+'/image/arbre/join.gif" align="absbottom" alt="" />')}else{document.write('<img src="'+resourceStaticPath+'/image/arbre/joinbottom.gif" align="absbottom" alt="" />')}}document.write('<a id="c'+nodeValues[0]+'" name="c'+nodeValues[0]+'" CLASS="unSelectedNode" href="'+nodeValues[3]+'" onmouseover="window.status=\''+nodeValues[2].replace(/\'/g,"\\'")+"';return true;\" onmouseout=\"window.status=' ';return true;\" OnClick=\"unSel();this.className='SelectedNode';\">");if(hcn){if(nodeValues[2]=="Action(s)"){document.write('<img id="icon'+nodeValues[0]+'" src="'+resourceStaticPath+"/image/arbre/action")}else{if(nodeValues[2].indexOf("pays")>-1){document.write('<img id="icon'+nodeValues[0]+'" src="'+resourceStaticPath+"/image/arbre/pays")}else{if(nodeValues[1]==0){document.write('<img id="icon'+nodeValues[0]+'" src="'+resourceStaticPath+"/image/arbre/onglet")}else{document.write('<img id="icon'+nodeValues[0]+'" src="'+resourceStaticPath+"/image/arbre/appli"+nodeValues[4])}}}if(ino){document.write("open")}document.write('.gif" align="absbottom" alt="Folder" />')}else{pNode=nodeValues[1]-1;pNodeValues=nodes[pNode].split("|");if(pNodeValues[2]=="Action(s)"){document.write('<img id="icon'+nodeValues[0]+'" src="'+resourceStaticPath+'/image/arbre/actionpage.gif" align="absbottom" alt="Page" />')}else{if(pNodeValues[2].indexOf("pays")>-1){document.write('<img id="icon'+nodeValues[0]+'" src="'+resourceStaticPath+'/image/arbre/payssubpage.gif" align="absbottom" alt="Page" />')}else{if(nodeValues[2].indexOf("pays")>-1){document.write('<img id="icon'+nodeValues[0]+'" src="'+resourceStaticPath+'/image/arbre/payspage.gif" align="absbottom" alt="Page" />')}else{document.write('<img id="icon'+nodeValues[0]+'" src="'+resourceStaticPath+'/image/arbre/page.gif" align="absbottom" alt="Page" />')}}}}document.write('<span id="treeText'+i+'">'+nodeValues[2]+"</span>");document.write("</a><br />");if(hcn){document.write('<div id="div'+nodeValues[0]+'"');if(!ino){document.write(' style="display: none;"')}document.write(">");addNode(resourceStaticPath,nodeValues[0],recursedNodes);document.write("</div>")}recursedNodes.pop()}}}function oc(node,bottom){try{var theDiv=document.getElementById("div"+node);var theJoin=document.getElementById("join"+node);var theIcon=document.getElementById("icon"+node);var nodeValues=nodes[node-1].split("|");var ico=0;if(theDiv.style.display=="none"){if(bottom==1){theJoin.src=icons[3].src}else{theJoin.src=icons[2].src}if(nodeValues[2]=="Action(s)"){ico=7}else{if(nodeValues[2].indexOf("pays")>-1){ico=9}else{if(nodeValues[1]==0){ico=11}else{if(nodeValues[4]=="on"){ico=13}else{ico=15}}}}theIcon.src=icons[ico].src;theDiv.style.display=""}else{if(bottom==1){theJoin.src=icons[1].src}else{theJoin.src=icons[0].src}if(nodeValues[2]=="Action(s)"){ico=6}else{if(nodeValues[2].indexOf("pays")>-1){ico=8}else{if(nodeValues[1]==0){ico=10}else{if(nodeValues[4]=="on"){ico=12}else{ico=14}}}}theIcon.src=icons[ico].src;theDiv.style.display="none"}}catch(e){}}if(!Array.prototype.push){function array_push(){for(var i=0;i<arguments.length;i++){this[this.length]=arguments[i]}return this.length}Array.prototype.push=array_push}if(!Array.prototype.pop){function array_pop(){lastElement=this[this.length-1];this.length=Math.max(this.length-1,0);return lastElement}Array.prototype.pop=array_pop}function unSel(){var i=document.links.length;var j=0;for(j=0;j<i;j++){document.links[j].className="unSelectedNode"}};
var SDECREASE=0;var MDECREASE=5;var UNESECONDE=1000;var UNEMINUTE=60*UNESECONDE;var HTTP_OK=200;var HTTP_RDY=4;var sDecrease=SDECREASE;var mDecrease=MDECREASE;var EXPIRED_SESSION_DIV_ID="page";var sessionTimeOut=UNEMINUTE*25;var expireSessionAlert="";var expireSessionActive="";var expireSessionMarque="";var expireSessionRoot="";var expireSessionEnd="";var stopDecount=1;var expireSessionTimeID=0;var internalHttpClient;function resetHubExpireSession(){if(expireSessionTimeID){clearTimeout(expireSessionTimeID);expireSessionTimeID=setTimeout("preventEndSession()",sessionTimeOut)}}function initExpireSession(initMsgExpire,initMsgActive,initMsgEnd,initMsgRoot,initMarque){expireSessionAlert=initMsgExpire;expireSessionActive=initMsgActive;expireSessionEnd=initMsgEnd;expireSessionRoot=initMsgRoot;expireSessionMarque=initMarque;expireSessionTimeID=setTimeout("preventEndSession()",sessionTimeOut)}function initExpireSessionCounter(){if(expireSessionTimeID){clearTimeout(expireSessionTimeID);expireSessionTimeID=0;preventEndSessionActivate()}}function preventEndSession(){str='<div class="expireSessionConteneur center">'+'<p class="expireSessionMsg">'+expireSessionAlert+"</p>"+'<p id="decrease" class="expireSessionMsg"></p>'+'<p><a class="expireSessionMsg" href="javascript:preventEndSessionActivate()">'+expireSessionActive+"</a></p>"+"</div>";if(document.getElementById){preload=document.getElementById("expireSessionContainer");preload.style.visibility="visible";preload.innerHTML=str}else{if(document.layers){document.expireSessionContainer.visibility="visible"}else{document.all.expireSessionContainer.style.visibility="visible"}}document.getElementById("decrease").innerHTML=mDecrease+":"+(sDecrease<10?"0"+sDecrease:sDecrease);stopDecount=0;document.getElementById(EXPIRED_SESSION_DIV_ID).className="expireSessionBodyOff";preventEndSessionDecrease()}function preventEndSessionDecrease(){var clockBlock=document.getElementById("decrease");if(clockBlock){clockBlock.innerHTML=mDecrease+":"+(sDecrease<10?"0"+sDecrease:sDecrease)}sDecrease--;if(sDecrease==-1){sDecrease=59;mDecrease--}if(mDecrease==-1){stopDecount=0;callExpiredSession()}if(stopDecount==0){setTimeout("preventEndSessionDecrease()",UNESECONDE)}}function preventEndSessionActivate(){stopDecount=1;sDecrease=SDECREASE;mDecrease=MDECREASE;document.getElementById(EXPIRED_SESSION_DIV_ID).className="expireSessionBodyOn";callReactivateSession();setTimeout("preventEndSession()",sessionTimeOut);if(document.getElementById){document.getElementById("expireSessionContainer");preload.style.visibility="hidden"}else{if(document.layers){document.expireSessionContainer.visibility="hidden"}else{document.all.expireSessionContainer.style.visibility="hidden"}}}function callReactivateSession(){getInternalHttpClient();internalHttpClient.onreadystatechange=function(){if(internalHttpClient.readyState==HTTP_RDY&&internalHttpClient.status==HTTP_OK){}};internalHttpClient.open("GET","/do/reactivateSession",true);internalHttpClient.send(null)}function callExpiredSession(){str='<div class="expireSessionConteneur"><span class="expireSessionMsg">'+expireSessionEnd+'<br/><a href="/" class="expireSessionMsg">'+expireSessionRoot+"</a></span></div>";if(document.getElementById){preload=document.getElementById("expireSessionContainer");preload.style.visibility="visible";preload.innerHTML=str}else{if(document.layers){document.expireSessionContainer.visibility="visible"}else{document.all.expireSessionContainer.style.visibility="visible"}}}function getInternalHttpClient(){if(window.XMLHttpRequest){internalHttpClient=new XMLHttpRequest()}else{if(window.ActiveXObject){try{internalHttpClient=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){internalHttpClient=new ActiveXObject("Microsoft.XMLHTTP")}}else{alert("Votre navigateur ne supporte pas les objets XMLHTTPRequest, veuillez le mettre à jour");internalHttpClient=false}}};
sfHover=function(){if(document.getElementById("menu")){var sfEls=document.getElementById("menu").getElementsByTagName("LI");for(var i=0;i<sfEls.length;i++){sfEls[i].onmouseover=function(){this.className+=" sfhover"};sfEls[i].onmouseout=function(){this.className=this.className.replace(new RegExp(" sfhover\\b"),"")}}}};if(window.attachEvent){window.attachEvent("onload",sfHover)}sfHover=function(){if(document.getElementById("panierAchats")){var sfEls=document.getElementById("panierAchats").getElementsByTagName("LI");for(var i=0;i<sfEls.length;i++){sfEls[i].onmouseover=function(){this.className+=" sfhover"};sfEls[i].onmouseout=function(){this.className=this.className.replace(new RegExp(" sfhover\\b"),"")}}}};if(window.attachEvent){window.attachEvent("onload",sfHover)}function toggle_visibility(id){var e=document.getElementById(id);if(e.style.display=="block"){e.style.display="none"}else{e.style.display="block"}}showNav=function(){var nav=document.getElementById("navigation");nav.style.display="block"};hideNav=function(){var nav=document.getElementById("navigation");nav.style.display="none"};function setCookie(name,value,expires,path,domain,secure){var today=new Date();today.setTime(today.getTime());if(expires){expires=expires*1000*60*60*24}var expires_date=new Date(today.getTime()+(expires));document.cookie=name+"="+escape(value)+((expires)?";expires="+expires_date.toGMTString():"")+((path)?";path="+path:"")+((domain)?";domain="+domain:"")+((secure)?";secure":"")};
function hideElement(id){var elt=document.getElementById(id);if(elt){elt.style.display="none"}}function showElement(id,displayStyle){displayStyle=displayStyle||"block";var elt=document.getElementById(id);if(elt){elt.style.display=displayStyle}}function reduceHub(){hideElement("navigation");hideElement("navMain");hideElement("recpetionDefault");var tools=document.getElementById("tools").getElementsByTagName("UL")[0];var toolsLI=tools.getElementsByTagName("LI");for(i=0;i<toolsLI.length;i++){if(i==0){toolsLI[i].className+=" first"}toolsLI[i].className+=" toolItem"}document.getElementById("menu").innerHTML+=tools.innerHTML;document.getElementById("show-menu-button").onmouseover=function(){showElement("navigation")};document.getElementById("show-menu-button").onmouseout=function(){hideElement("navigation")};document.getElementById("navigation").onmouseover=function(){showElement("navigation")};document.getElementById("navigation").onmouseout=function(){hideElement("navigation")};document.body.className="smallhub";if(typeof agaLayout!="undefined"){agaLayout.resizeAll()}SmallHub.setCookie("IS_SMALL_HUB","true")}function growHub(){showElement("navMain");var menu=document.getElementById("menu");var toolsLI=menu.getElementsByTagName("LI");for(i=0;i<toolsLI.length;i++){if(toolsLI[i].className.indexOf("toolItem")>=0){menu.removeChild(toolsLI[i--])}}showElement("navigation");showElement("recpetionDefault");document.getElementById("show-menu-button").onmouseout=function(){};document.getElementById("navigation").onmouseout=function(){};document.body.className="";if(agaLayout){agaLayout.resizeAll()}SmallHub.setCookie("IS_SMALL_HUB","false")}var SmallHub={setCookie:function(name,value,expires,path,domain,secure){var today=new Date();today.setTime(today.getTime());if(expires){expires=expires*1000*60*60*24}var expires_date=new Date(today.getTime()+(expires));document.cookie=name+"="+escape(value)+((expires)?";expires="+expires_date.toGMTString():"")+((path)?";path="+path:"")+((domain)?";domain="+domain:"")+((secure)?";secure":"")},getCookie:function(check_name){var a_all_cookies=document.cookie.split(";");var a_temp_cookie="";var cookie_name="";var cookie_value="";var b_cookie_found=false;for(i=0;i<a_all_cookies.length;i++){a_temp_cookie=a_all_cookies[i].split("=");cookie_name=a_temp_cookie[0].replace(/^\s+|\s+$/g,"");if(cookie_name==check_name){b_cookie_found=true;if(a_temp_cookie.length>1){cookie_value=unescape(a_temp_cookie[1].replace(/^\s+|\s+$/g,""))}return cookie_value;break}a_temp_cookie=null;cookie_name=""}if(!b_cookie_found){return null}}};
function validateMaxLength(form){var isValid=true;var focusField=null;var i=0;var fields=new Array();oMaxLength=new maxlength();for(x in oMaxLength){var field=form[oMaxLength[x][0]];if(field.type=="text"||field.type=="textarea"){var iMax=parseInt(oMaxLength[x][2]("maxlength"));if(field.value.length>iMax){if(i==0){focusField=field}fields[i++]=oMaxLength[x][1];isValid=false}}}if(fields.length>0){try{focusField.focus()}catch(err){}alert(fields.join("\n"))}return isValid}function copyVIN(button){var vin=document.getElementById("short-vin").value.replace(/ /g,"");button.form.jvin.value=vin;return true}function validateRequired(form){var isValid=true;var focusField=null;var i=0;var fields=new Array();oRequired=eval("new "+form.name+"_required()");for(x in oRequired){var field=form[oRequired[x][0]];if(field.type=="text"||field.type=="textarea"||field.type=="file"||field.type=="select-one"||field.type=="radio"||field.type=="password"){var value="";if(field.type=="select-one"){var si=field.selectedIndex;if(si>=0){value=field.options[si].value}}else{value=field.value}if(trim(value).length==0){if(i==0){focusField=field}fields[i++]=oRequired[x][1];isValid=false}}}if(fields.length>0){try{focusField.focus()}catch(err){}alert(fields.join("\n"))}return isValid}function trim(s){return s.replace(/^\s*/,"").replace(/\s*$/,"")}function validateMask(form){var isValid=true;var focusField=null;var i=0;var j=0;var fields=new Array();oMasked=eval("new "+form.name+"_mask()");for(x in oMasked){var field=form[oMasked[x][0]];if((form.name!="vehicule")||(form.name=="vehicule"&&(form["rechImmat"].value=="false"&&j==0)||form["rechImmat"].value=="true"&&j==1)){if((field.type=="text"||field.type=="textarea")&&(field.value.length>0)){if(!matchPattern(field.value,oMasked[x][2]("mask"))){if(i==0){focusField=field}fields[i++]=oMasked[x][1];isValid=false}}j++}else{j++}}if(fields.length>0){try{focusField.focus()}catch(err){}alert(fields.join("\n"))}return isValid}function matchPattern(value,mask){return mask.exec(value)}function splitJvin(okform){vin=okform["jvin"].value;if(vin.length==17){okform["wmi"].value=vin.substr(0,3);okform["vds"].value=vin.substr(3,6);okform["vis"].value=vin.substr(9,8)}else{okform["wmi"].value="";okform["vds"].value="";okform["vis"].value=vin}return true}function goTo(pageRequested){waitJbnPreloadPageAffiche();if(pageRequested=="/agenda/"){document.frmMenu1.method="GET"}document.frmMenu1.action=pageRequested;document.frmMenu1.submit()}function goToDi(urlPart,panierPart,tabControlID){var currentHost="http://"+window.location.host;var urlRequest=urlPart+currentHost+panierPart;waitJbnPreloadPageAffiche();document.location=urlRequest}function waitJbnPreloadPage(){if(document.getElementById){document.getElementById("jbnpreLoad").style.visibility="hidden"}else{if(document.layers){document.jbnpreLoad.visibility="hidden"}else{document.all.jbnpreLoad.style.visibility="hidden"}}}function trim(inputString){return inputString.replace(/^\s+/,"").replace(/\s+$/,"")}function setTitle(doc,user){if(doc.title==""){if(doc.getElementById){title=doc.getElementById("globalTitle");var titlePrefix="";if(title){if(doc.all){titlePrefix=title.innerHTML+" - "}else{titlePrefix=title.textContent+" - "}}buf=doc.getElementById("buffer");if(buf){tables=buf.getElementsByTagName("table");var titleObject;for(i=0;i<tables.length;i++){if(tables[i].rows.length==1&&tables[i].rows[0].cells.length==4){titleObject=tables[i].rows[0].cells[1];break}}if(!titleObject){dts=buf.getElementsByTagName("dt");if(dts){titleObject=dts[0]}}if(titleObject){if(titleObject.innerText){doc.title=titlePrefix+titleObject.innerText}else{for(i=0;i<titleObject.childNodes.length;i++){if(titleObject.childNodes[i].nodeType==3){doc.title=titlePrefix+trim(titleObject.childNodes[i].nodeValue);break}}}}}}}if(doc.title==""){doc.title=titlePrefix+doc.title+user}else{doc.title=doc.title+" - "+user}}function getFormValues(fobj,valFunc){var str="";var valueArr=null;var val="";var cmd="";for(var i=0;i<fobj.elements.length;i++){switch(fobj.elements[i].type){case"text":if(valFunc){cmd=valFunc+"("+"fobj.elements[i].value"+")";val=eval(cmd)}str+=fobj.elements[i].name+"="+escape(fobj.elements[i].value)+"&";break;case"select-one":str+=fobj.elements[i].name+"="+fobj.elements[i].options[fobj.elements[i].selectedIndex].value+"&";break}}str=str.substr(0,(str.length-1));return str}var Hub={init:function(){Hub.setDatasHint()},refreshIcons:function(){HTTPGet("/do/refreshInfos?type=icons",function(text){document.getElementById("hub-icons").innerHTML=text;getDmbrStatus()})},refreshDatas:function(){HTTPGet("/do/refreshInfos?type=datas",function(text){Hub.setDatas(text)})},refreshVin:function(){HTTPGet("/do/refreshInfos?type=vin",function(text){document.getElementById("short-vin").value=text.replace(/\s/g,"");callApiBoxForBAM(0);callApiBoxForVS(0);getDmbrStatus()})},refresh:function(){Hub.refreshVin();Hub.refreshDatas();Hub.refreshIcons()},setDatas:function(html){document.getElementById("infosAPV").innerHTML=html;Hub.setDatasHint()},setDatasHint:function(){var infosAPV=document.getElementById("infosAPV"),text=infosAPV.textContent||infosAPV.innerText;document.getElementById("infosAPVClip").title=text.replace(/\s+/g," ").replace(/(^\s)|(\s$)/g,"")},getDatas:function(){return document.getElementById("infosAPV").innerHTML},setVin:function(vin){document.getElementById("short-vin").value=vin.replace(/\s/g,"")},getVin:function(){return document.getElementById("short-vin").value},setDatasVehicule:function(html){document.getElementById("infosVehicule").innerHTML=html},getDatasVehicule:function(){return document.getElementById("infosVehicule").innerHTML},clear:function(){HTTPGet("/do/clearDatas",function(text){Hub.setDatas("");Hub.setVin("VIN/VIS");Hub.refreshIcons()})},filterOff:function(){document.getElementById("strikeDam").style.textDecoration="line-through"},filterOn:function(){document.getElementById("strikeDam").style.textDecoration="none"}};
var listeErreur=new Array();var imageSize=3000054;var uriResource="/autodiagnostic/test.bmp";var uriDiagnostic="/do/autoDiagnostic";var urlPortail="";var nbUsers;var typeConnexion;var sTypeConnexion;var http_request;var versionFirefox;var matriceDebit=new Array();matriceDebit[0]=512;matriceDebit[1]=1024;matriceDebit[2]=2048;matriceDebit[3]=4096;var helpMapURI=new Object();helpMapURI["helpActivationAjax"]="helpAjax.jsp";helpMapURI["helpBandWidth"]="helpBandWidth.jsp";var jbnResourcePath="";var packPerfActive=false;var meteoCSSB={};var listeGroupeFonctionPackPerf=[];function areNavigatorFunctionsEnabled(){resetAndHide();setTimeout("launchTests()",2000)}function resetAndHide(){listeErreur=new Array();jQueryJBN("#printId").hide();jQueryJBN("#resultWait").show();jQueryJBN("#resultOk,#resultNotOk").hide();jQueryJBN("#browserName").text("");jQueryJBN("#navigator").hide();jQueryJBN("#osName").text("");jQueryJBN("#os").hide();jQueryJBN("#dmsOk").hide();jQueryJBN("#dmsNotOk").hide();jQueryJBN("#accesCSSBNotOk, #accesCSSBOk").hide();jQueryJBN("#typeReseauId").hide();jQueryJBN("#latenceDiv").hide();jQueryJBN("#latenceSpan").html("");jQueryJBN("#latenceId").val("");jQueryJBN("#ProgressBP, #bandWidthOk, #bandWidthNotOk, #bandWidthUnknown").hide();nbUsers=jQueryJBN("#nbUsersId").val();var nb=parseInt(nbUsers);if(isNaN(nb)||nb<1){nb=1}else{if(nb>999){nb=999}}nbUsers=nb;jQueryJBN("#nbUsersId").val(nb);jQueryJBN("#imgMeteoCSSB,#divMeteoCSSBMessageInfo,#tablePackPerf").hide();jQueryJBN("#tbodyPackPerf").empty();jQueryJBN("#divPackPerfMsgLancement").show()}function launchTests(){recupererDonnees();checkNavigator();checkOperatingSystem();gererMeteoCSSB();gererPackPerf();determinatePortailUrl();checkDms();jQueryJBN("#typeReseauId").show();checkLatence(urlPortail);calculateBandwidth(urlPortail);traitementFinal()}function gererPackPerf(){if(packPerfActive){if(null!=listeGroupeFonctionPackPerf){var tbody=jQueryJBN("#tbodyPackPerf");var groupe=null;var fonctionnalite=null;var tr=null;for(var i=0;i<listeGroupeFonctionPackPerf.length;i++){groupe=listeGroupeFonctionPackPerf[i];tr=jQueryJBN("<tr>").attr("class",(i%2==0?"even":"odd"));tr.append(jQueryJBN("<td class='tdCenter'>").attr("rowspan",groupe.listeFonctionPackPerf.length).text(groupe.libelle));tbody.append(tr);for(var j=0;j<groupe.listeFonctionPackPerf.length;j++){fonctionnalite=groupe.listeFonctionPackPerf[j];if(0<j){tr=jQueryJBN("<tr>").attr("class",(i%2==0)?"even":"odd");tbody.append(tr)}ajouterTDFonctionnalitePackPerf(tr,fonctionnalite)}}jQueryJBN("#tablePackPerf").show();jQueryJBN("#divPackPerfMsgLancement").hide()}}}function ajouterTDFonctionnalitePackPerf(tr,fonctionnalite){tr.append(jQueryJBN("<td>").text(fonctionnalite.libelle)).append(jQueryJBN("<td class='tdCenter'>").append(jQueryJBN("<input type='button' class='bt bt-help'>").click(function(event){var windowName=fonctionnalite.libelle;var url=fonctionnalite.urlHTTP;if("https:"==window.location.protocol){url=fonctionnalite.urlHTTPS}window.open(url,windowName.replace(/\W*/g,""))}))).append(jQueryJBN("<td class='tdCenter'>").append(jQueryJBN("<img>").attr({src:(fonctionnalite.active?jbnResourcePath+"/images/status-3-vert.gif":jbnResourcePath+"/images/status-3-rouge.gif")}))).append(jQueryJBN("<td class='tdCenter'>").text(fonctionnalite.commentaire))}function determinatePortailUrl(){var currentUrl=window.location.toString();var endIndexPortailUrl=currentUrl.indexOf(uriDiagnostic);urlPortail=currentUrl.substring(0,endIndexPortailUrl);jQueryJBN("#accesCSSB").html(urlPortail);document.getElementById("accesCSSBNotOk").style.display="none";document.getElementById("accesCSSBOk").style.display="block";document.getElementById("urlPortailId").value=urlPortail}function recupererDonnees(){jQueryJBN.ajax({async:false,url:uriDiagnostic,data:{mode:"recupererDonnees"},success:function(ajaxResultat,textStatus,jqXHR){if(null!=ajaxResultat){if(0<=ajaxResultat.etat){meteoCSSB=ajaxResultat.meteoCSSB;jQueryJBN("#meteoCSSBEtat").val(meteoCSSB.etat);jQueryJBN("#meteoCSSBMessageInfo").val(meteoCSSB.messageInfo);listeGroupeFonctionPackPerf=ajaxResultat.listeGroupeFonctionPackPerf}else{meteoCSSB=null;listeGroupeFonctionPackPerf=null}}else{meteoCSSB=null;listeGroupeFonctionPackPerf=null;console.log("La rÃ©ponse du serveur est null pour la rÃ©cupÃ©ration des donnÃ©es.")}},error:function(jqXHR,textStatus,errorThrown){meteoCSSB=null;listeGroupeFonctionPackPerf=null;console.log(textStatus,errorThrown)}})}function checkNavigator(){jQueryJBN("#meteoCSSBMessageInfo").val("");if(null!=meteoCSSB){jQueryJBN("#meteoCSSBMessageInfo").val(meteoCSSB.messageInfo);if(null!=meteoCSSB.navigateur){jQueryJBN("#browserName").text(meteoCSSB.navigateur.nomCommercial);jQueryJBN("#meteoCSSBNavigateurNomCommercial").val(meteoCSSB.navigateur.nomCommercial);jQueryJBN("#imgBrowserOK").show();jQueryJBN("#imgBrowserKO").hide()}else{jQueryJBN("#browserName").text(meteoCSSB.libelleNavigateurInconnu);jQueryJBN("#meteoCSSBNavigateurNomCommercial").val(meteoCSSB.libelleNavigateurInconnu);jQueryJBN("#imgBrowserOK").hide();jQueryJBN("#imgBrowserKO").show();listeErreur.push("navigator",false)}}else{jQueryJBN("#browserName").text(libelleErreurMeteoCSSB);jQueryJBN("#meteoCSSBNavigateurNomCommercial").val(libelleErreurMeteoCSSB);jQueryJBN("#imgBrowserOK").hide();jQueryJBN("#imgBrowserKO").show();listeErreur.push("navigator",false)}jQueryJBN("#navigator").show()}function checkOperatingSystem(){if(null!=meteoCSSB){if(null!=meteoCSSB.os){jQueryJBN("#meteoCSSBOSNomCommercial").val(meteoCSSB.os.nomCommercial);jQueryJBN("#osName").text(meteoCSSB.os.nomCommercial);jQueryJBN("#imgOSOK").show();jQueryJBN("#imgOSKO").hide()}else{jQueryJBN("#meteoCSSBOSNomCommercial").val(meteoCSSB.libelleOSInconnu);jQueryJBN("#osName").text(meteoCSSB.libelleOSInconnu);jQueryJBN("#imgOSOK").hide();jQueryJBN("#imgOSKO").show();listeErreur.push("os",false)}}else{jQueryJBN("#meteoCSSBOSNomCommercial").val(libelleErreurMeteoCSSB);jQueryJBN("#osName").text(libelleErreurMeteoCSSB);jQueryJBN("#imgOSOK").hide();jQueryJBN("#imgOSKO").show();listeErreur.push("os",false)}jQueryJBN("#os").show()}function gererMeteoCSSB(){if(null!=meteoCSSB){var urlIcone=jbnResourcePath+"/images/meteo/";switch(meteoCSSB.etat){case 0:urlIcone+="Vide.png";break;case 1:urlIcone+="Soleil.png";break;case 2:urlIcone+="S.Couvert.png";break;case 3:urlIcone+="Nuage.png";break;case 4:urlIcone+="Pluie.png";break;case 5:urlIcone+="Tempete.png";break;default:urlIcone+="Vide.png"}jQueryJBN("#imgMeteoCSSB").attr("src",urlIcone).show();if(null!=meteoCSSB.messageInfo){jQueryJBN("#divMeteoCSSBMessageInfo").text(meteoCSSB.messageInfo).show();jQueryJBN("#meteoCSSBMessageInfo").val(meteoCSSB.messageInfo)}}}function checkDms(){if(window.XMLHttpRequest&&!document.all){if(fireFoxPrior35()){try{window.netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead")}catch(e){jQueryJBN("#dmsNotOk").show();listeErreur.push("dms",false);return}}http_request=new XMLHttpRequest();if(http_request.overrideMimeType){http_request.overrideMimeType("text/plain")}}else{if(window.ActiveXObject){http_request=new ActiveXObject("Microsoft.XMLHTTP")}else{jQueryJBN("#dmsNotOk").show();listeErreur.push("dms",false);return}}checkCrossSite()}function fireFoxPrior35(){var isFf=false;if(versionFirefox!=null){var indexDot=versionFirefox.indexOf(".");var version=versionFirefox.substring(0,indexDot+2);version=version.replace(".","");if(version<=35){isFf=true}}return isFf}function checkCrossSite(){if(urlDms==null||urlDms=="null"){jQueryJBN("#dmsNotOk").show();return}try{if(http_request){http_request.open("POST",urlDms,false);http_request.setRequestHeader("Content-Type","application/x-www-form-urlencoded");http_request.onreadystatechange=function(){if(http_request.readyState==4){if(http_request.status==200){document.getElementById("dmsOk").style.display="block";document.getElementById("dmsNotOk").style.display="none";document.getElementById("enableDmsId").value=true}else{document.getElementById("dmsOk").style.display="none";document.getElementById("dmsNotOk").style.display="block";document.getElementById("enableDmsId").value=false;listeErreur.push("dms",false)}}else{}};http_request.send("")}}catch(e){document.getElementById("dmsOk").style.display="none";document.getElementById("dmsNotOk").style.display="block";document.getElementById("enableDmsId").value=false;listeErreur.push("dms",false)}}function checkLatence(sSiteATester){var xmlhttp;var startTimeTest;if(window.XMLHttpRequest&&!document.all){if(fireFoxPrior35()){try{window.netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead")}catch(e){alert(e.message);listeErreur.push("latence",false);return}}xmlhttp=new XMLHttpRequest();if(xmlhttp.overrideMimeType){xmlhttp.overrideMimeType("text/plain")}}else{if(window.ActiveXObject){xmlhttp=new ActiveXObject("Microsoft.XMLHTTP")}else{alert(e.message);listeErreur.push("latence",false);return}}sleep(500);var uriResourceLatence="/autodiagnostic/latence.txt";try{xmlhttp.open("GET",sSiteATester+uriResourceLatence,true);xmlhttp.setRequestHeader("Content-Type","text/plain");xmlhttp.onreadystatechange=function(){if(xmlhttp.readyState==4){if(xmlhttp.status==200){var stop=(new Date()).getTime();jQueryJBN("#latenceSpan").html(stop-startTimeTest+" ms");jQueryJBN("#latenceDiv").show();document.getElementById("latenceId").value=stop-startTimeTest+" ms"}else{}}};startTimeTest=(new Date()).getTime();xmlhttp.send(null)}catch(e){alert("latence : "+e.message)}}function calculateBandwidth(sSiteATester){document.getElementById("ProgressBP").style.display="block";var xmlhttp;var startTimeTest;if(window.XMLHttpRequest&&!document.all){if(fireFoxPrior35()){try{window.netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead")}catch(e){alert(e.message);jQueryJBN("#ProgressBP").hide();document.getElementById("bandWidthNotOk").style.display="block";document.getElementById("bandWidthOk").style.display="none";listeErreur.push("bandWidth",false);return}}xmlhttp=new XMLHttpRequest();if(xmlhttp.overrideMimeType){xmlhttp.overrideMimeType("text/plain")}}else{if(window.ActiveXObject){xmlhttp=new ActiveXObject("Microsoft.XMLHTTP")}else{document.getElementById("ProgressBP").style.display="none";alert(e.message);document.getElementById("bandWidthNotOk").style.display="block";document.getElementById("bandWidthOk").style.display="none";listeErreur.push("bandWidth",false);return}}sleep(500);try{xmlhttp.open("GET",sSiteATester+uriResource,true);xmlhttp.onreadystatechange=function(){if(xmlhttp.readyState==4){if(xmlhttp.status==200){var stop=(new Date()).getTime();taux=calculeTauxTransfert(imageSize,startTimeTest,stop);var tauxOctet=taux/8;var tauxOctetFormate=formateTaux(tauxOctet);document.getElementById("bandWidthId").value=tauxOctet;enregistrerClasseBP();if(taux>512){document.getElementById("bandWidthOk").getElementsByTagName("span")[0].firstChild.data=tauxOctetFormate;document.getElementById("bandWidthOk").getElementsByTagName("span")[1].firstChild.data=sTypeConnexion;document.getElementById("bandWidthOk").style.display="block";document.getElementById("bandWidthNotOk").style.display="none";document.getElementById("bandWidthUnknown").style.display="none"}else{document.getElementById("bandWidthNotOk").getElementsByTagName("span")[0].firstChild.data=tauxOctetFormate;document.getElementById("bandWidthNotOk").getElementsByTagName("span")[1].firstChild.data=sTypeConnexion;document.getElementById("bandWidthNotOk").style.display="block";document.getElementById("bandWidthOk").style.display="none";document.getElementById("bandWidthUnknown").style.display="none";listeErreur.push("bandWidth",false)}document.getElementById("ProgressBP").style.display="none"}else{jQueryJBN("#ProgressBP").html("");document.getElementById("bandWidthUnknown").style.display="block"}}else{}};startTimeTest=(new Date()).getTime();xmlhttp.send(null)}catch(e){alert("BP : "+e.message);document.getElementById("bandWidthNotOk").style.display="none";document.getElementById("bandWidthOk").style.display="none";document.getElementById("bandWidthUnknown").style.display="block";listeErreur.push("bandWidth",false)}}function sleep(millis){var date=new Date();var curDate=null;do{curDate=new Date()}while(curDate-date<millis)}function calculeTauxTransfert(iTailleOctets,start,stop){var vitesse=(iTailleOctets/(stop-start))*1000;var taux=Math.round(((vitesse/1024)*8));if(taux>0&&taux<=64){sTypeConnexion="Modem 64k";typeConnexion=0}else{if(taux>64&&taux<=256){sTypeConnexion="ADSL 256k";typeConnexion=0}else{if(taux>256&&taux<=512){sTypeConnexion="ADSL 512k";typeConnexion=0}else{if(taux>512&&taux<=1024){sTypeConnexion="ADSL 1024k";typeConnexion=1}else{if(taux>1024&&taux<=2048){typeConnexion=2}else{if(taux>2048&&taux<=4096){typeConnexion=3}else{if(taux>1024&&taux<=4096){sTypeConnexion="ADSL 4M";typeConnexion=3}else{if(taux>4096){sTypeConnexion="ADSL > 4M";typeConnexion=3}}}}}}}}return taux}function formateTaux(tauxOctet){var tauxFormate="";var tauxStr=tauxOctet.toString();var indexDot=tauxStr.indexOf(".");var prefixe="";var suffixe="";if(indexDot>-1){prefixe=tauxStr.substring(0,indexDot);suffixe=tauxStr.substring(indexDot,tauxStr.length)}else{prefixe=tauxStr}for(i=prefixe.length-1,j=1;i>=0;i--,j++){tauxFormate=prefixe.charAt(i)+tauxFormate;if(j==3){tauxFormate=" "+tauxFormate;j=0}}return tauxFormate+suffixe}function enregistrerClasseBP(){var tempsMatrice=calculateLoadTime();var classBp="";if(tempsMatrice==null||tempsMatrice==""||tempsMatrice>10){classBp="F"}else{if(tempsMatrice>5&&tempsMatrice<=10){classBp="E"}else{if(tempsMatrice>3&&tempsMatrice<=5){classBp="D"}else{if(tempsMatrice>2&&tempsMatrice<=3){classBp="C"}else{if(tempsMatrice>1&&tempsMatrice<=2){classBp="B"}else{if(tempsMatrice<=1){classBp="A"}}}}}}jQueryJBN("#classBpId").val(classBp)}function calculateLoadTime(){var bandePassanteParUser=5;var ratio=0.8;var taille=150;var val=taille*8/(matriceDebit[typeConnexion]*ratio-(nbUsers-1)*bandePassanteParUser*8);if(val<0){val=11}return val}function traitementFinal(){jQueryJBN("#intro").hide();if(listeErreur.length==0){jQueryJBN("#resultOk").show();jQueryJBN("#resultNotOk").hide()}else{jQueryJBN("#resultOk").hide();jQueryJBN("#resultNotOk").show()}document.getElementById("dateId").value=new Date().getTime();jQueryJBN("#resultWait").hide();jQueryJBN("#printId").show()}function showHelp(sFrameId,sCleAide){var sURL="/pages/autodiagnostic/"+helpMapURI[sCleAide];jQueryJBN("#"+sFrameId).show();jQueryJBN("#"+sFrameId+"src").attr("src",sURL);jQueryJBN("#"+sFrameId+"src").load(showRightBrowser)}function showRightBrowser(){if(navigator.userAgent){var userAgent=navigator.userAgent.toLowerCase();if(userAgent.indexOf("firefox")!=-1){showHelpFirefox()}else{if(userAgent.indexOf("microsoft internet explorer")!=-1||userAgent.indexOf("msie")!=-1){showHelpIE()}else{if(userAgent.indexOf("opera")!=-1){showHelpOpera()}else{if(userAgent.indexOf("safari")!=-1){showHelpSafari()}else{showHelpFirefox();showHelpOpera();showHelpSafari();showHelpIE()}}}}}}function showHelpFirefox(){jQueryJBN("#frame0src").contents().find("#firefox").show()}function showHelpOpera(){jQueryJBN("#frame0src").contents().find("#opera").show()}function showHelpSafari(){jQueryJBN("#frame0src").contents().find("#safari").show()}function showHelpIE(){jQueryJBN("#frame0src").contents().find("#ie").show()};
function confirmAndAddPlaque(){confirmAndSubmitPlaque(msgConfirmAddPlaque,"addPlaque")}function confirmAndSetNewPlaque(){confirmAndSubmitPlaque(msgConfirmSetNewPlaque,"setDefaultPlaque")}function confirmAndDeletePlaque(plaque){document.getElementById("plaqueToDelete").value=plaque;confirmAndSubmitPlaque(msgConfirmDeletePlaque,"deletePlaque")}function confirmAndUpdatePays(){confirmAndSubmitPlaque(msgConfirmUpdateAffectation,"updatePaysPlaque")}function confirmAndAddPays(){var msg=msgConfirmAddPays.replace(new RegExp("(%pays)","g"),document.getElementById("nouveauPays").value);confirmAndSubmitPlaque(msg,"addPays")}function confirmAndSubmitPlaque(message,actionStruts){var isConfirmed=confirm(message);if(isConfirmed){var form=document.getElementById("plaqueFormId");form.action=actionStruts;form.submit()}else{return false}}function addUrl(){var form=document.getElementById("plaqueFormId");form.action="welcomeAddUrlPlaque";form.submit()}function modifyUrl(){var form=document.getElementById("plaqueFormId");form.action="welcomeModifyUrlPlaque";form.submit()}function showUrl(numeroDiv){for(var i=0;i<nbPlaque;i++){document.getElementById(i).style.display="none"}document.getElementById(numeroDiv).style.display="block"};
function launchPromotionPr(fromButton,parameter){var xhr=null;if(window.XMLHttpRequest&&!document.all){try{window.netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead")}catch(e){}}try{xhr=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){xhr=new XMLHttpRequest()}if(console&&debug){console.log("DÃ©but AJAX PAT ...")}var url="/relay/invokePat";if(parameter){url+="?promoBrand="+parameter}xhr.open("GET",url,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(debug){console.log("Fin AJAX PAT ...")}if(xhr.status==200){if(debug){console.log("DÃ©but rÃ©ponse OK")}var e=document.getElementById("scriptPromo");var script=xhr.responseText.replace(/(\$|jQuery)\(/g,"jQueryJBN(").replace(/(\$|jQuery)\./g,"jQueryJBN.");var newjs=document.createElement("script");newjs.type="text/javascript";if(navigator.appName=="Microsoft Internet Explorer"){newjs.text=script}else{newjs.innerHTML=script}e.appendChild(newjs);if(debug){console.log("Injection rÃ©ponse ...")}existsScriptPromo=(typeof afficheLightbox==="function");if(debug){console.log("afficheLightbox : "+(typeof afficheLightbox))}if(fromButton){if(debug){console.log("Affichage rÃ©ponse ... click")}jQueryJBN("#promotionsPR").click()}else{if(existsScriptPromo){if(debug){console.log("Affichage rÃ©ponse ... affiche")}afficheLightbox()}}if(debug){console.log("Fin rÃ©ponse OK")}}}};xhr.send(null)}function onMouseOverPromotionPR(event){jQueryJBN("#sousMenuPromotion").show()}function onMouseOutPromotionPR(event){jQueryJBN("#sousMenuPromotion").hide()}function onClickMiseEnAvantPromotionnelle(){if(existsScriptPromo){jQueryJBN("#promotionsPR").click()}else{launchPromotionPr(true)}};
function deleteRedirection(id){if(confirm("ÃŠtes-vous sÃ»r de vouloir supprimer cette redirection?")){document.getElementById("action").value="remove";document.getElementById("id").value=id;document.getElementById("appRedirectionForm").submit()}}function updateRedirection(){if(!confirm("/!\\ Cette action peut entraÃ®ner une action nÃ©faste.\nA utiliser qu'en cas extrÃªme.\n")){return}document.getElementById("action").value="update";document.getElementById("appRedirectionForm").submit()}function exportRedirection(){document.getElementById("action").value="export";document.getElementById("appRedirectionForm").submit()}function addRedirection(){if(document.getElementById("idUtilisateur").value==""&&document.getElementById("groupe").value==""){alert("Veuillez renseigner un utilisateur ou un groupe.")}else{document.getElementById("action").value="add";document.getElementById("appRedirectionForm").submit()}}function searchRedirection(){document.getElementById("action").value="search";document.getElementById("appRedirectionForm").submit()}function activeRedirection(id){document.getElementById("action").value="active";document.getElementById("id").value=id;document.getElementById("appRedirectionForm").submit()}function desactiveRedirection(id){document.getElementById("action").value="desactive";document.getElementById("id").value=id;document.getElementById("appRedirectionForm").submit()}function razChamps(){document.getElementById("action").value="raz";document.getElementById("appRedirectionForm").submit()}function importeRedirections(){document.getElementById("appRedirectionfileUploadForm").submit()}function confirmerImport(){if(confirm("Voulez-vous importer le nouveau fichier?")){this.importeRedirections()}};
function applicationChange(obj){td=obj.parentNode;if(obj.value=="supprimer"){doOpac(td);for(x=0;x<td.childNodes.length;x++){var element=td.childNodes.item(x);if(element.nodeName=="SELECT"&&element!=obj){element.disabled=true}}}else{doNotOpac(td);for(x=0;x<td.childNodes.length;x++){var element=td.childNodes.item(x);if(element.nodeName=="SELECT"&&element!=obj){element.disabled=false}}}}function addMessage(obj){form=obj.form;for(x=0;x<form.elements.length;x++){var element=form.elements[x];if(element.nodeName=="SELECT"){element.disabled=false}}obj.form.submit()}function deleteMessage(obj,idMessage){var isConfirmed=confirm("Voulez-vous supprimer ce message?");if(isConfirmed){document.getElementsByName("todo").item(0).value="delete";document.getElementsByName("idMessage").item(0).value=idMessage;obj.form.submit()}}function deleteAllMessages(obj){form=obj.form;for(x=0;x<form.elements.length;x++){var element=form.elements[x];if(element.nodeName=="SELECT"){element.disabled=true}}var isConfirmed=confirm("Voulez-vous supprimer tous les messages?");if(isConfirmed){document.getElementsByName("todo").item(0).value="deleteAll";document.getElementsByName("todo").item(1).value="deleteAll";form.submit()}else{for(x=0;x<form.elements.length;x++){var element=form.elements[x];if(element.nodeName=="SELECT"){element.disabled=false}}}}function onDetleteAllChange(obj){form=obj.form;if(!obj.checked){form.reset();obj.value="false"}else{obj.value="true"}for(x=0;x<form.elements.length;x++){var element=form.elements[x];if(element.nodeName=="SELECT"){if(obj.checked){if(element.name.indexOf("resourceName")>0){doOpac(element.parentNode);element.selectedIndex=element.options.length-1}else{element.disabled=true}}else{if(element.name.indexOf("resourceName")>0){doNotOpac(element.parentNode)}element.disabled=false}}}}function onSelectChange(obj){form=obj.form;query=getFormValues(form);url="/do/ajaxMessages?todo=ajax&"+query;HTTPGet(url,doRenderMessage,form);obj.blur()}function doRenderMessage(text,http,form){var messageDiv=document.getElementById("ajaxdiv");var tab=text.split("|");if(tab.length==2){if(messageDiv){messageDiv.innerHTML=tab[0]}var partNames=eval(tab[1]);updateFormState(partNames,form)}}function updateFormState(partNames,form){var begindate=enddate=begintime=endtime=false;for(i=0;i<partNames.length;i++){if(partNames[i]=="begindate"){begindate=true}if(partNames[i]=="enddate"){enddate=true}if(partNames[i]=="begintime"){begintime=true}if(partNames[i]=="endtime"){endtime=true}}if(!enddate){if(!begindate||!endtime){var endDate=new Date();var opts;if(!endtime){endDate.setMonth(endDate.getMonth()+1)}opts=form["newMessage.enddate.month"].options;for(i=0;i<opts.length;i++){opts[i].selected=(opts[i].value==endDate.getMonth()+1)}}}for(x=0;x<form.elements.length;x++){var element=form.elements[x];if(element.nodeName=="SELECT"){if(element.name.indexOf("begindate")>0){element.disabled=!begindate}if(element.name.indexOf("enddate")>0){element.disabled=false}if(element.name.indexOf("begintime")>0){element.disabled=!begintime}if(element.name.indexOf("endtime")>0){element.disabled=!endtime}}}}function doOpac(obj){if(document.all){obj.style.filter="alpha(opacity=50)"}else{obj.style.opacity="0.5"}}function doNotOpac(obj){if(document.all){obj.style.filter="alpha(opacity=100)"}else{obj.style.opacity="1.0"}};
function confirmAndAddMachine(){confirmAndSubmit(msgConfirmAddMachine,"welcomeMaintenanceMachines?action=ADD")}function confirmAndDeleteMachine(){confirmAndSubmit(msgConfirmDeleteMachine,"welcomeMaintenanceMachines?action=DEL")}function updateMaintenanceMachines(truc,lastValue){var ok=check(truc,lastValue);if(ok){var valueTrucSplite=truc.value.split("_");if(valueTrucSplite.length==2){var nomMachine=valueTrucSplite[0];var isEnMaintenance=valueTrucSplite[1];var confirm=confirmAndSubmit(msgConfirmUpdateMachines,"welcomeMaintenanceMachines?action=UPD&machine="+nomMachine+"&isEnMaintenance="+isEnMaintenance);if(!confirm){rechargeAvant(truc,lastValue)}}}}function rechargeAvant(truc,lastValue){var value=truc.value.split("_");var id=value[0]+"_"+lastValue;var trucACocher=document.getElementById(id);truc.checked="";trucACocher.checked="checked"}function check(truc,lastValue){var value=truc.value.split("_");if(value[1]!="0"){var unPasCocher=false;for(var i=0;i<nbMachines;i++){var radios=document.getElementsByName("radio["+i+"]");var radio=radios[0];var valeur=radio.value.split("_");if(valeur[1]=="0"&&valeur[0]!=value[0]){if(radio.checked){unPasCocher=true;break}}else{if((valeur[1]!="0")&&valeur[0]!=value[0]){if(!radio.checked){unPasCocher=true;break}}}}if(unPasCocher){return true}else{alert(msgTropDeMachineEnMaintenance);rechargeAvant(truc,lastValue);return false}}return true}function confirmAndSubmit(message,actionStruts){var isConfirmed=confirm(message);if(isConfirmed){var form=document.getElementById("machinesFormId");form.action=actionStruts;form.submit();return true}else{return false}};
